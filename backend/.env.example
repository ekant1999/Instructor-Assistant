OPENAI_API_KEY=
LITELLM_MODEL=gpt-5-mini
SUMMARY_PROVIDER=openai

# Canvas integration (optional)
CANVAS_API_URL=
CANVAS_ACCESS_TOKEN=
CANVAS_COURSE_ID=

# Local LLM (Ollama or compatible)
LOCAL_LLM_URL=http://localhost:11434
LOCAL_LLM_MODEL=llama3.1:8b
LOCAL_LLM_TIMEOUT=60

# MCP server for question context uploads
LOCAL_MCP_SERVER_URL=http://127.0.0.1:8020/mcp

# Qwen agent (Ollama)
QWEN_AGENT_MODEL=qwen2.5:7b

# Optional SearXNG instance for web search
SEARXNG_URL=

# For image indexing
ENABLE_IMAGE_INDEX=true

# Figure extraction controls
FIGURE_VECTOR_ENABLED=true
FIGURE_VECTOR_RENDER_SCALE=2.0
FIGURE_VECTOR_DEDUP_IOU=0.82
FIGURE_VECTOR_EMBEDDED_IOU_SKIP=0.88
FIGURE_VECTOR_MAX_ABOVE_PT=380
FIGURE_VECTOR_MAX_BELOW_PT=240
FIGURE_VECTOR_MIN_WINDOW_HEIGHT_PT=36
FIGURE_VECTOR_MIN_DRAWING_SIDE_PT=0.8
FIGURE_VECTOR_MIN_DRAWING_COUNT=6
FIGURE_VECTOR_MIN_REGION_AREA_PT=5000
FIGURE_VECTOR_MIN_REGION_SIDE_PT=40
FIGURE_VECTOR_MARGIN_PT=6
FIGURE_VECTOR_COLUMN_X_PAD_PT=28
FIGURE_VECTOR_MIN_X_OVERLAP_RATIO=0.05

# For structured table extraction (PyMuPDF find_tables)
TABLE_EXTRACTION_ENABLED=true
TABLE_MIN_ROWS=2
TABLE_MIN_COLS=2
TABLE_MIN_AREA_PT=1600
TABLE_MERGE_VERTICAL_GAP_PT=14
TABLE_MERGE_X_OVERLAP_RATIO=0.9
TABLE_TEXT_FALLBACK_ENABLED=true
TABLE_TEXT_FALLBACK_MAX_ABOVE_PT=320
TABLE_TEXT_FALLBACK_MAX_BELOW_PT=260
TABLE_TEXT_FALLBACK_MIN_CLIP_HEIGHT_PT=48
TABLE_TEXT_FALLBACK_X_MARGIN_PT=8
TABLE_TEXT_FALLBACK_CAPTION_GAP_PT=110
TABLE_TEXT_FALLBACK_MIN_X_OVERLAP_RATIO=0.15
TABLE_TEXT_FALLBACK_MAX_PAGE_AREA_RATIO=0.65
TABLE_TEXT_FALLBACK_MIN_WIDTH_RATIO=0.20
TABLE_TEXT_FALLBACK_MAX_CANDIDATES_PER_CAPTION=1
TABLE_DEDUP_IOU_THRESHOLD=0.80
TABLE_MAX_ROWS_PER_CHUNK=12
TABLE_CHUNK_MAX_CHARS=2200
TABLE_CAPTION_MAX_DISTANCE_PT=120
TABLE_FALSE_POSITIVE_MIN_SIGNALS=2

# ============================================================================
# PostgreSQL Configuration (for pgvector migration)
# ============================================================================
# PostgreSQL connection string
# Format: postgresql://user:password@host:port/database
DATABASE_URL=postgresql://instructor:password@localhost:5432/instructor_assistant

# Connection pool settings
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=10

# ============================================================================
# Embedding Configuration
# ============================================================================
# Embedding model (upgraded to all-mpnet-base-v2 for 768D embeddings)
EMBEDDING_MODEL=sentence-transformers/all-mpnet-base-v2
EMBEDDING_DIMENSION=768
EMBEDDING_DEVICE=cpu  # or 'cuda' if GPU available

# ============================================================================
# pgvector Configuration
# ============================================================================
# Vector index type (hnsw, ivfflat, or flat)
PGVECTOR_INDEX_TYPE=hnsw

# HNSW index parameters (only used if PGVECTOR_INDEX_TYPE=hnsw)
# m: number of connections per layer (higher = better recall, more memory)
HNSW_M=16
# ef_construction: size of dynamic candidate list (higher = better quality, slower build)
HNSW_EF_CONSTRUCTION=64
# ef_search: size of dynamic candidate list during search (higher = better recall, slower)
HNSW_EF_SEARCH=40

# ============================================================================
# Search Configuration
# ============================================================================
# Hybrid search alpha weight (0=keyword only, 1=vector only, 0.5=balanced)
HYBRID_SEARCH_ALPHA=0.5

# Default number of search results
DEFAULT_SEARCH_K=10

GROBID_URL=http://127.0.0.1:8070
GROBID_TIMEOUT=45
GROBID_INCLUDE_SUBSECTIONS=1
